{"version":3,"sources":["assets/placeholder.png","assets/shopping.svg","helpers/roles.js","helpers/getUser.js","helpers/createUrl.js","helpers/fetchWithAuth.js","components/AuthContext.js","components/ProtectedRoute.js","components/Form.js","components/TextInput.js","components/Loader.js","components/SignUpForm.js","components/LoginForm.js","components/Modal.js","components/IconButton.js","components/Notifications.js","components/Navbar.js","components/ListingHolder.js","components/Image.js","components/ListingPreview.js","pages/LandingPage.js","components/Offers.js","components/ListingData.js","components/OfferForm.js","components/ProfilePreview.js","pages/ListingPage.js","components/TextArea.js","components/EditForm.js","components/RatingForm.js","components/RatingsHolder.js","components/RatingsAverage.js","pages/ProfilePage.js","pages/VerificationPage.js","components/FileInput.js","components/CreateListingForm.js","pages/CreateListingPage.js","serviceWorker.js","index.js","App.js"],"names":["module","exports","user","localStorage","getItem","JSON","parse","error","console","endpoint","params","url","URL","key","searchParams","append","init","getUser","options","headers","authorization","accessToken","rest","fetch","AuthContext","createContext","isAuthenticated","login","logout","AuthProvider","props","formData","a","createUrl","method","credentials","body","stringify","response","ok","json","setAccessToken","status","fetchWithAuth","log","removeAccess","refresh","setState","jwtDecode","id","exp","username","role","toExpire","Date","setItem","clearTimeout","refreshTimeout","setTimeout","removeItem","state","this","Provider","value","children","Component","component","render","level","authContext","useContext","redirect","to","pathname","from","location","initRequest","multipart","request","asJson","forEach","val","toUpperCase","submit","event","target","preventDefault","setLoader","FormData","auth","reset","onSuccess","onError","autoComplete","onSubmit","label","type","name","className","placeholder","htmlFor","ref","setRef","res","submitting","responseMsg","err","Response","errors","join","TextInput","required","Loader","context","resetPassword","email","document","getElementById","message","onClick","contextType","modalRef","outClick","contains","hide","open","isOpen","addEventListener","setOpener","setCloser","removeEventListener","title","aria-label","icon","Notification","_id","listingId","createdAt","userId","remove","removeNotif","toLocaleString","NotificationPanel","aria-labelledby","notifications","map","notif","idx","NotificationButton","panelIsOpen","panelRef","getUnreadNotifs","filter","isUnseen","onNewNotif","messageEvent","data","n","markNotifsAsSeen","dbUrl","streamUrl","notifStream","EventSource","withCredentials","close","length","unreadNotifs","Helmet","titleTemplate","IconButton","aria-haspopup","aria-expanded","mobileNavIsOpen","Consumer","openSignupModal","openLoginModal","setListingEndpoint","listingsEndpoint","limit","page","listings","loadListings","next","uniqueListings","find","l","intersectionHandler","entries","some","e","isIntersecting","loaderRef","instersectionObserver","observe","lastOptions","IntersectionObserver","currentOptions","disconnect","src","alt","useState","source","setSource","errored","setErrored","Placeholder","description","images","Image","substring","searchOptions","setSearchOptions","content","onChange","searchString","ShoppingImage","ListingPreview","RealOffer","setAccept","accepted","split","listingName","creatorId","creatorListingId","userUrl","listingUrl","Promise","all","listing","jsonCalls","push","listingCreator","Offer","withRouter","offers","offer","settings","window","reload","userID","userName","loadListing","notFound","removeListing","match","history","alert","nextProps","ROLES","openOfferForm","maxLength","changeDescription","changeLocation","TextArea","comment","isPositive","changeComment","changeRating","getRatings","i","item","ratings","ratingArray","getVotes","votes","totalPositive","totalNegative","loadUser","openEditModal","verifying","URLSearchParams","search","get","filenames","setFilenames","input","useRef","current","click","files","Array","prototype","call","f","FileInput","multiple","Boolean","hostname","ReactDOM","path","exact","LandingPage","ListingPage","ProfilePage","VerificationPage","ProtectedRoute","CreateListingPage","navigator","serviceWorker","ready","then","registration","unregister","catch"],"mappings":"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","file":"static/js/main.5a522e93.chunk.js","sourcesContent":["module.exports = __webpack_public_path__ + \"static/media/placeholder.bdfe38ff.png\";","module.exports = __webpack_public_path__ + \"static/media/shopping.dbe2ef14.svg\";","export default {\r\n  BASIC: 1,\r\n  ADMIN: 2\r\n}\r\n","/**\r\n * Gets user from localStorage.\r\n *\r\n * @returns {Object|null} User if found, null otherwise\r\n */\r\nexport default () => {\r\n  let user = localStorage.getItem('jid')\r\n\r\n  if (user !== null) {\r\n    try {\r\n      user = JSON.parse(user)\r\n    } catch (error) {\r\n      console.error(\"Can't parse userdata from localStorage. Log out and log back in to store valid userdata.\")\r\n      user = null\r\n    }\r\n  }\r\n\r\n  return user\r\n}\r\n","/**\r\n * Creates a URL from endpoint and adds GET parameters.\r\n * \r\n * @param {String} endpoint URL or URI, if no host is supplied, uses `http://localhost:5000`\r\n * @param {Object} params HTTP GET parameters to add to the URL.\r\n * @returns {URL} Created URL object\r\n */\r\nexport default (endpoint, params = {}) => {\r\n  const url = new URL('/api' + endpoint, 'https://swapza-beta.herokuapp.com')\r\n\r\n  for (const key in params) {\r\n    url.searchParams.append(key, params[key])\r\n  }\r\n\r\n  return url\r\n}\r\n","import getUser from './getUser'\r\n\r\n/**\r\n * Fetches URL with credentials of user found in localStorage.\r\n * \r\n * @param {String} url URL to fetch.\r\n * @param {Object} init Options for request, merged with auth options.\r\n * @returns {Promise} HTTP response\r\n */\r\nexport default (url, init = null) => {\r\n  const user = getUser()\r\n  let options = {\r\n    // credentials: 'include',\r\n    headers: {\r\n      authorization: `Bearer ${user.accessToken}`\r\n    }\r\n  }\r\n\r\n  if (init !== null) {\r\n    const { headers, ...rest } = init\r\n    \r\n    if (headers) {\r\n      options.headers = { ...options.headers, ...headers }\r\n    }\r\n\r\n    options = { ...options, ...rest }\r\n  }\r\n\r\n  return fetch(url, options)\r\n}\r\n","import React, { Component, createContext } from 'react'\r\nimport jwtDecode from 'jwt-decode'\r\n\r\nimport getUser from '../helpers/getUser'\r\nimport createUrl from '../helpers/createUrl'\r\nimport fetchWithAuth from '../helpers/fetchWithAuth'\r\n\r\nexport const AuthContext = createContext({\r\n  isAuthenticated: false,\r\n  login: () => {},\r\n  logout: () => {}\r\n})\r\n\r\nexport class AuthProvider extends Component {\r\n  constructor (props) {\r\n    super(props)\r\n    this.refreshTimeout = null\r\n    this.state = {\r\n      // Load initial state from storage to prevent redirect\r\n      isAuthenticated: null !== localStorage.getItem('jid')\r\n    }\r\n  }\r\n\r\n  componentDidMount () {\r\n    const user = getUser()\r\n\r\n    if (user !== null) {\r\n      if (!this.setAccessToken(user.accessToken)) {\r\n        this.refresh()\r\n      }\r\n    }\r\n  }\r\n\r\n  componentWillUnmount () {\r\n    clearTimeout(this.refreshTimeout)\r\n  }\r\n\r\n  login = async (formData) => {\r\n    const url = createUrl('/auth/login')\r\n\r\n    try {\r\n      const response = await fetch(url, {\r\n        method: 'POST',\r\n        credentials: 'include',\r\n        headers: {\r\n          'Content-Type': 'application/json'\r\n        },\r\n        body: JSON.stringify(formData)\r\n      })\r\n\r\n      if (response.ok) {\r\n        const { accessToken } = await response.json()\r\n        return this.setAccessToken(accessToken)\r\n      } else {\r\n        return response.status\r\n      }\r\n    } catch (err) {\r\n      return err\r\n    }\r\n  }\r\n\r\n  logout = async () => {\r\n    const url = createUrl('/auth/logout')\r\n\r\n    try {\r\n      const response = await fetchWithAuth(url, {\r\n        method: 'DELETE'\r\n      })\r\n\r\n      switch (response.status) {\r\n        case 204:\r\n          console.log('[logout]', 'Refresh token is now invalidated.')\r\n          break\r\n        case 401:\r\n          console.error('[logout]', 'Invalid or empty refresh token sent.')\r\n          break\r\n        case 403:\r\n          console.error('[logout]', 'Refresh token was already invalidated.')\r\n          break\r\n        default:\r\n          console.error('[logout]', 'Something went wrong with the request')\r\n      }\r\n    } catch (err) {\r\n      console.error('[logout]', err)\r\n    }\r\n\r\n    this.removeAccess()\r\n  }\r\n\r\n  refresh = async () => {\r\n    const url = createUrl('/auth/refresh')\r\n\r\n    try {\r\n      const response = await fetch(url, {\r\n        credentials: 'include'\r\n      })\r\n\r\n      if (response.ok) {\r\n        const { accessToken } = await response.json()\r\n        this.setAccessToken(accessToken)\r\n      } else {\r\n        this.setState({ isAuthenticated: false })\r\n        console.error('[refresh]', 'Something went wrong')\r\n      }\r\n    } catch (err) {\r\n      this.setState({ isAuthenticated: false })\r\n      console.error('[refresh]', err)\r\n    }\r\n  }\r\n\r\n  setAccessToken = accessToken => {\r\n    const { id, exp /*sec*/, username, role } = jwtDecode(accessToken)\r\n    const expiresAt = new Date(exp * 1000 /*ms*/)\r\n    const today = new Date()\r\n    const toExpire = expiresAt - today\r\n\r\n    if (toExpire <= 0) {\r\n      this.removeAccess()\r\n      return false\r\n    }\r\n\r\n    localStorage.setItem('jid', JSON.stringify({ id, accessToken, username, role }))\r\n    this.setState({ isAuthenticated: true })\r\n\r\n    clearTimeout(this.refreshTimeout)\r\n    this.refreshTimeout = setTimeout(this.refresh, toExpire)\r\n\r\n    return true\r\n  }\r\n\r\n  removeAccess = () => {\r\n    localStorage.removeItem('jid')\r\n    this.setState({ isAuthenticated: false })\r\n    clearTimeout(this.refreshTimeout)\r\n  }\r\n\r\n  render () {\r\n    return (\r\n      <AuthContext.Provider\r\n        value={{\r\n          isAuthenticated: this.state.isAuthenticated,\r\n          login: this.login,\r\n          logout: this.logout\r\n        }}\r\n      >\r\n        { this.props.children }\r\n      </AuthContext.Provider>\r\n    )\r\n  }\r\n}\r\n","import React, { useContext } from 'react'\r\nimport { Route, Redirect } from 'react-router-dom'\r\n\r\nimport getUser from '../helpers/getUser'\r\nimport { AuthContext } from './AuthContext'\r\n\r\nexport default ({ component: Component, render, level, ...rest }) => {\r\n  const authContext = useContext(AuthContext)\r\n\r\n  return (\r\n    <Route\r\n      {...rest}\r\n      render={props => {\r\n        const redirect = <Redirect to={{ pathname: \"/\", state: { from: props.location }}} />\r\n\r\n        if (!authContext.isAuthenticated) return redirect\r\n\r\n        const { role } = getUser()\r\n        \r\n        if (!role || role < level) return redirect\r\n\r\n        return render ? render(props) : <Component {...props} />\r\n      }}\r\n    />\r\n  )\r\n}\r\n","import React, { Component } from 'react'\r\n\r\nimport fetchWithAuth from '../helpers/fetchWithAuth'\r\nimport createUrl from '../helpers/createUrl'\r\n\r\n/**\r\n * @param {String}   url       The endpoint to submit the form to.\r\n * @param {String}   method    HTTP method for submitting.\r\n * @param {Function} onSuccess Called with response when submitted.\r\n * @param {Function} onError   Called with error or response error.\r\n * @param {Function} setLoader Optional. Set parents state for rendering Loader.\r\n * @param {Function} onSubmit  Optional. Override the forms onSubmit.\r\n * @param {Boolean}  auth      Optional. Set to true if protected route.\r\n * @param {Boolean}  multipart Optional. Set to true if sending files.\r\n */\r\nexport default class extends Component {\r\n  /** @param {FormData} formData */\r\n  initRequest = (formData) => {\r\n    let { method = 'GET', multipart, url } = this.props\r\n    const request = { method }\r\n\r\n    let asJson = {}\r\n    formData.forEach((val, key) => { asJson[key] = val })\r\n\r\n    if (method.toUpperCase() === 'GET') {\r\n      url = createUrl(url, asJson)\r\n    } else if (multipart) {\r\n      request.body = formData\r\n    } else {\r\n      request.body = JSON.stringify(asJson)\r\n      request.headers = { 'Content-Type': 'application/json' }\r\n    }\r\n\r\n    return [url, request]\r\n  }\r\n\r\n  submit = async event => {\r\n    const target = event.target\r\n    event.preventDefault()\r\n    this.props.setLoader && this.props.setLoader()\r\n    const formData = new FormData(target) \r\n    const [url, request] = this.initRequest(formData)   \r\n\r\n    try {\r\n      const response = this.props.auth\r\n        ? await fetchWithAuth(url, request)\r\n        : await fetch(url, request)\r\n\r\n      if (response.ok) {\r\n        target.reset()\r\n        this.props.onSuccess(response)\r\n      } else {\r\n        this.props.onError(response)\r\n      }\r\n    } catch (err) {\r\n      this.props.onError(err)\r\n    }\r\n  }\r\n\r\n  render () {\r\n    return (\r\n      <form\r\n        autoComplete=\"off\"\r\n        onSubmit={this.props.onSubmit || this.submit}\r\n      >\r\n        {this.props.children}\r\n      </form>\r\n    )\r\n  }\r\n}\r\n","import React from 'react'\r\n\r\nexport default ({ id, label, type, name, ...rest }) => (\r\n  <div className=\"input-float-label\">\r\n    <input\r\n      id={id}\r\n      name={name || id}\r\n      placeholder={label}\r\n      type={type || \"text\"}\r\n      {...rest} />\r\n    <label htmlFor={id}>{label}</label>\r\n  </div>\r\n)\r\n","import React from 'react'\r\nimport '../styles/loader.scss'\r\n\r\nexport default (props) => {\r\n  if ('setRef' in props) {\r\n    return <div ref={props.setRef} className=\"loader\">Loading...</div>\r\n  } else {\r\n    return <div className=\"loader\">Loading...</div>\r\n  }\r\n}\r\n","import React, { Component } from 'react'\r\n\r\nimport Form from './Form'\r\nimport TextInput from './TextInput'\r\nimport Loader from './Loader'\r\nimport createUrl from '../helpers/createUrl'\r\n\r\nexport default class extends Component {\r\n  constructor (props) {\r\n    super(props)\r\n    this.state = {\r\n      responseMsg: '',\r\n      submitting: false\r\n    }\r\n  }\r\n\r\n  onSuccess = (res) => {\r\n    this.setState({\r\n      submitting: false,\r\n      responseMsg: 'Rekisteröity! Vahvista sähköpostisi.'\r\n    })\r\n  }\r\n\r\n  onError = async (err) => {\r\n    if (err instanceof Response) {\r\n      const body = await err.json()\r\n\r\n      this.setState({\r\n        submitting: false,\r\n        responseMsg: body.errors.join(' ')\r\n      })\r\n    } else {\r\n      this.setState({\r\n        submitting: false,\r\n        responseMsg: 'Jotain meni pieleen...'\r\n      })\r\n    }\r\n  }\r\n\r\n  render () {\r\n    return (\r\n      <>\r\n        <h2>Rekisteröidy</h2>\r\n        <Form\r\n          url={createUrl('/users')}\r\n          method=\"POST\"\r\n          setLoader={() => this.setState({ submitting: true })}\r\n          onSuccess={this.onSuccess}\r\n          onError={this.onError}\r\n        >\r\n          <TextInput\r\n            label=\"Sähköposti\" id=\"signup_email\" name=\"email\" type=\"email\" required\r\n          />\r\n          <TextInput\r\n            label=\"Käyttäjänimi\" id=\"signup_username\" name=\"username\" required\r\n          />\r\n          <TextInput\r\n            label=\"Salasana\" id=\"signup_password\" name=\"password\" type=\"password\" required\r\n          />\r\n\r\n          {this.state.submitting\r\n            ? <Loader />\r\n            : <button type=\"submit\" className=\"btn-primary\">\r\n                Sign up\r\n              </button>\r\n          }\r\n        </Form>\r\n        {this.state.responseMsg && <p>{this.state.responseMsg}</p>}\r\n      </>\r\n    )\r\n  }\r\n}\r\n","import React, { Component } from 'react'\r\n\r\nimport Form from './Form'\r\nimport TextInput from './TextInput'\r\nimport Loader from './Loader'\r\n\r\nimport { AuthContext } from './AuthContext'\r\nimport createUrl from '../helpers/createUrl'\r\n\r\nexport default class extends Component {\r\n  static contextType = AuthContext\r\n\r\n  constructor (props) {\r\n    super(props)\r\n    this.state = {\r\n      responseMsg: '',\r\n      submitting: false\r\n    }\r\n  }\r\n\r\n  submit = async (event) => {\r\n    event.preventDefault()\r\n    this.setState({ submitting: true })\r\n    let formData = {}\r\n    new FormData(event.target)\r\n      .forEach((value, key) => formData[key] = value)\r\n\r\n    const status = await this.context.login(formData)\r\n    let responseMsg = ''\r\n\r\n    switch (status) {\r\n      case 404:\r\n        responseMsg = 'Käyttäjää ei löytynyt.'\r\n        break\r\n      case 401:\r\n        responseMsg = 'Salasana on väärä.'\r\n        break\r\n      case 403:\r\n        responseMsg = 'Sähköpostia ei ole vahvistettu!'\r\n        break\r\n      case true:\r\n        responseMsg = 'Kirjautuminen onnistui!'\r\n        break\r\n      default:\r\n        responseMsg = 'Jotain meni pieleen...'\r\n    }\r\n\r\n    this.setState({ submitting: false, responseMsg })\r\n  }\r\n\r\n  resetPassword = async () => {\r\n    const email = document.getElementById('login_email').value\r\n    const url = createUrl('/users/reset-password')\r\n\r\n    try {\r\n      const response = await fetch(url, {\r\n        method: 'PUT',\r\n        headers: {\r\n          'Content-Type': 'application/json'\r\n        },\r\n        body: JSON.stringify({ email })\r\n      })\r\n\r\n      if (response.ok) {\r\n        this.setState({ responseMsg: 'Salasana resetoitu, katso sähköpostisi.' })\r\n      } else {\r\n        this.setState({ responseMsg: 'Ei onnistunut resetoimaan. Varmista, että sähköpostisi on oikein kirjoitettu.' })\r\n      }\r\n    } catch (error) {\r\n      this.setState({ responseMsg: error.message })\r\n    }\r\n  }\r\n\r\n  render () {\r\n    return (\r\n      <>\r\n        <h2>Kirjaudu sisään</h2>\r\n        <Form onSubmit={this.submit}>\r\n          <TextInput\r\n            label=\"Sähköposti\"\r\n            id=\"login_email\"\r\n            name=\"email\"\r\n            type=\"email\"\r\n            required\r\n          />\r\n          <TextInput\r\n            label=\"Salasana\"\r\n            id=\"login_password\"\r\n            name=\"password\"\r\n            type=\"password\"\r\n            required\r\n          />\r\n\r\n          {this.state.submitting\r\n            ? <Loader />\r\n            : <div>\r\n                <button type=\"submit\" className=\"btn-primary\">\r\n                  Kirjaudu sisään\r\n                </button>\r\n                <button className=\"btn\" type=\"button\" onClick={this.resetPassword}>\r\n                  Unohdin salasanani\r\n                </button>\r\n              </div>\r\n          }\r\n        </Form>\r\n        \r\n        {this.state.responseMsg && <p>{this.state.responseMsg}</p>}\r\n      </>\r\n    )\r\n  }\r\n}\r\n","import React, { Component } from 'react'\r\n\r\nimport '../styles/modal.scss'\r\n\r\nexport default class extends Component {\r\n  constructor (props) {\r\n    super(props)\r\n    this.state = {\r\n      isOpen: false\r\n    }\r\n  }\r\n  \r\n  componentDidMount () {\r\n    document.addEventListener('mousedown', this.outClick)\r\n    // Give parents access to opening & closing\r\n    this.props.setOpener && this.props.setOpener(this.open)\r\n    this.props.setCloser && this.props.setCloser(this.hide)\r\n  }\r\n\r\n  componentWillUnmount () {\r\n    document.removeEventListener('mousedown', this.outClick)\r\n  }\r\n\r\n  setRef = (ref) => {\r\n    this.modalRef = ref\r\n  }\r\n\r\n  outClick = (event) => {\r\n    if (this.modalRef && !this.modalRef.contains(event.target)) {\r\n      this.hide()\r\n    }\r\n  }\r\n\r\n  open = () => {\r\n    this.setState({ isOpen: true })\r\n  }\r\n\r\n  hide = () => {\r\n    this.setState({ isOpen: false })\r\n  }\r\n  \r\n  render () {\r\n    return (\r\n      <div className={'modal-bg' + (this.state.isOpen ? ' active' : '')}>\r\n        <div ref={this.setRef} className=\"modal\">\r\n          <button\r\n            title=\"Close popup\"\r\n            aria-label=\"Close popup\"\r\n            onClick={this.hide}\r\n            className=\"btn-close\">\r\n          </button>\r\n\r\n          {this.props.children}\r\n        </div>\r\n      </div>\r\n    )\r\n  }\r\n}\r\n","import React from 'react'\r\nimport { Link } from 'react-router-dom'\r\n\r\nimport '../styles/iconButtons.scss'\r\n\r\nexport default ({ to, icon, label, title, className, ...rest }) => {\r\n  if (to) {\r\n    return (\r\n      <Link\r\n        to={to}\r\n        className={\"nav-btn \" + (className || '')}\r\n        title={title || label}\r\n        {...rest}\r\n      >\r\n        <i className={\"icon-\" + icon}></i>\r\n        <span>{label}</span>\r\n      </Link>\r\n    )\r\n  }\r\n  else {\r\n    return (\r\n      <button\r\n        className={\"nav-btn \" + (className || '')}\r\n        title={title || label}\r\n        {...rest}\r\n      >\r\n        <i className={\"icon-\" + icon}></i>\r\n        <span>{label}</span>\r\n      </button>\r\n    )\r\n  }\r\n}\r\n","import React, { Component } from 'react'\r\nimport { Helmet } from 'react-helmet'\r\nimport { Link } from 'react-router-dom'\r\n\r\nimport fetchWithAuth from '../helpers/fetchWithAuth'\r\nimport createUrl from '../helpers/createUrl'\r\nimport getUser from '../helpers/getUser'\r\n\r\nimport IconButton from './IconButton'\r\nimport '../styles/Notifications.scss'\r\n\r\nconst formatTime = (time) => {\r\n  const date = new Date(time)\r\n  return date.toLocaleString()\r\n}\r\n\r\nconst Notification = (props) => {\r\n  const { _id, listingId, title, createdAt } = props\r\n  const userId = getUser().id\r\n\r\n  const remove = async () => {\r\n    const url = createUrl(`/users/${userId}/notifs/${_id}`)\r\n    \r\n    try {\r\n      const res = await fetchWithAuth(url, {\r\n        method: 'DELETE'\r\n      })\r\n\r\n      if (res.ok) {\r\n        props.removeNotif()\r\n      } else {\r\n        console.error(res)\r\n      }\r\n    } catch (error) {\r\n      console.error(error)\r\n    }\r\n  }\r\n  \r\n  return (\r\n    <>\r\n      <Link to={`/listings/${listingId}`}>\r\n        <span>{title}</span>\r\n        <span>{formatTime(createdAt)}</span>\r\n      </Link>\r\n      <button\r\n        onClick={remove}\r\n        title=\"Remove\"\r\n        className=\"btn-close small\"\r\n      ></button>\r\n    </>\r\n  )\r\n}\r\n\r\nconst NotificationPanel = (props) => {\r\n  return (\r\n    <div\r\n      ref={props.setRef}\r\n      aria-labelledby=\"notifications\"\r\n      className={'expandable' + (props.isOpen ? ' active' : '')}\r\n    >\r\n      <ul>\r\n        {props.notifications.map((notif, idx) => (\r\n          <li key={idx} className=\"notif\">\r\n            <Notification {...notif} />\r\n          </li>\r\n        ))}\r\n      </ul>\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default class NotificationButton extends Component {\r\n  constructor (props) {\r\n    super(props)\r\n    this.state = {\r\n      notifications: [],\r\n      panelIsOpen: false\r\n    }\r\n  }\r\n\r\n  async componentDidMount () {\r\n    const { id } = getUser()\r\n    const dbUrl = createUrl(`/users/${id}/notifs`)\r\n    const streamUrl = createUrl(`/users/${id}/notifs/stream`)\r\n\r\n    try {\r\n      const response = await fetchWithAuth(dbUrl)\r\n\r\n      if (response.ok) {\r\n        const notifications = await response.json()\r\n        this.setState({\r\n          notifications: notifications.map((notif) => {\r\n            notif.removeNotif = () => {\r\n              this.setState(state => ({\r\n                notifications: state.notifications\r\n                  .filter(n => n._id !== notif._id)\r\n              }))\r\n            }\r\n\r\n            return notif\r\n          })\r\n        })\r\n      } else {\r\n        console.error(response)\r\n      }\r\n    } catch (error) {\r\n      console.error(error)\r\n    }\r\n\r\n    this.notifStream = new EventSource(streamUrl, { withCredentials: true })\r\n    this.notifStream.addEventListener('message', this.onNewNotif)\r\n  }\r\n\r\n  componentWillUnmount () {\r\n    if (this.notifStream) {\r\n      this.notifStream.removeEventListener('message', this.onNewNotif)\r\n      this.notifStream.close()\r\n    }\r\n  }\r\n\r\n  componentDidUpdate () {\r\n    if (this.state.panelIsOpen && this.getUnreadNotifs().length) {\r\n      this.markNotifsAsSeen()\r\n    }\r\n  }\r\n\r\n  outClick = (event) => {\r\n    if (this.state.panelIsOpen && this.panelRef && !this.panelRef.contains(event.target)) {\r\n      this.hide()\r\n    }\r\n  }\r\n\r\n  open = () => {\r\n    this.setState({ panelIsOpen: true })\r\n    document.addEventListener('click', this.outClick)\r\n  }\r\n\r\n  hide = () => {\r\n    this.setState({ panelIsOpen: false })\r\n    document.removeEventListener('click', this.outClick)\r\n  }\r\n\r\n  getUnreadNotifs = () => {\r\n    return this.state.notifications.filter(notif => notif.isUnseen)\r\n  }\r\n  \r\n  onNewNotif = (messageEvent) => {\r\n    const notif = JSON.parse(messageEvent.data)\r\n\r\n    notif.removeNotif = () => {\r\n      this.setState(state => ({\r\n        notifications: state.notifications\r\n          .filter(n => n._id !== notif._id)\r\n      }))\r\n    }\r\n\r\n    this.setState(state => ({\r\n      notifications: [notif, ...state.notifications]\r\n    }))\r\n  }\r\n\r\n  markNotifsAsSeen = async () => {\r\n    this.setState(({ notifications }) => ({\r\n      notifications: notifications.map(notif => {\r\n        if (notif.isUnseen) notif.isUnseen = false\r\n        return notif\r\n      })\r\n    }))\r\n\r\n    const url = createUrl(`/users/${getUser().id}/notifs/mark-read`)\r\n\r\n    try {\r\n      const response = await fetchWithAuth(url, { method: 'PUT' })\r\n\r\n      if (response.ok) {\r\n        console.log('Notifs marked as seen!')\r\n      } else {\r\n        console.error('Something went wrong', response)\r\n      }\r\n    } catch (error) {\r\n      console.error(error)\r\n    }\r\n  }\r\n\r\n  render () {\r\n    const unreadNotifs = this.getUnreadNotifs().length\r\n\r\n    return (\r\n      <div className=\"notifs\">\r\n        <Helmet\r\n          titleTemplate={unreadNotifs ?\r\n            `(${unreadNotifs}) %s - Swapza`\r\n            : '%s - Swapza'}\r\n        />\r\n\r\n        <IconButton\r\n          onClick={() => this.state.panelIsOpen ? this.hide() : this.open()}\r\n          label=\"Ilmoitukset\"\r\n          icon=\"alarm\"\r\n          aria-haspopup=\"true\"\r\n          aria-expanded={this.state.panelIsOpen}\r\n          id=\"notifications\"\r\n          {...(() => unreadNotifs && { 'data-notifs': unreadNotifs })()}\r\n        />\r\n\r\n        <NotificationPanel\r\n          isOpen={this.state.panelIsOpen}\r\n          setRef={ref => this.panelRef = ref}\r\n          notifications={this.state.notifications}\r\n        />\r\n      </div>\r\n    )\r\n  }\r\n}\r\n","import React, { Component } from 'react'\r\nimport { Link } from 'react-router-dom'\r\n\r\nimport SignUpForm from './SignUpForm'\r\nimport LoginForm from './LoginForm'\r\nimport Modal from './Modal'\r\nimport NotificationButton from './Notifications'\r\nimport IconButton from './IconButton'\r\n\r\nimport { AuthContext } from './AuthContext'\r\n\r\nimport '../styles/Navbar.scss'\r\nimport '../styles/forms.scss'\r\nimport getUser from '../helpers/getUser'\r\n\r\nexport default class extends Component {\r\n  constructor (props) {\r\n    super(props)\r\n    this.state = {\r\n      mobileNavIsOpen: false\r\n    }\r\n  }\r\n\r\n  render () {\r\n    return (\r\n      <AuthContext.Consumer>\r\n        {context => (\r\n          <>\r\n            {context.isAuthenticated || (\r\n              <>\r\n                <Modal setOpener={open => this.openSignupModal = open}>\r\n                  <SignUpForm />\r\n                </Modal>\r\n    \r\n                <Modal setOpener={open => this.openLoginModal = open}>\r\n                  <LoginForm />\r\n                </Modal>\r\n              </>\r\n            )}\r\n    \r\n            <header className=\"navbar\">\r\n              <div className=\"wrap\">\r\n                <nav>\r\n                  <Link to=\"/\" className=\"logo\">Swapza</Link>\r\n\r\n                  <div className={this.state.mobileNavIsOpen ? 'active' : ''}>\r\n                    {context.isAuthenticated ? (\r\n                      <>\r\n                        <NotificationButton />\r\n                        <IconButton\r\n                          to=\"/create\"\r\n                          label=\"Luo uusi\"\r\n                          title=\"Luo uusi listaus\"\r\n                          icon=\"edit-1\"\r\n                        />\r\n                        <IconButton\r\n                          to={'/users/' + getUser().id}\r\n                          label=\"Profiili\"\r\n                          title=\"Katso ja muokkaa omaa profiiliasi\"\r\n                          icon=\"user-2\"\r\n                        />\r\n                        <IconButton\r\n                          onClick={() => context.logout()}\r\n                          label=\"Kirjaudu ulos\"\r\n                          title=\"Kirjaudu ulos\"\r\n                          icon=\"padlock-1\"\r\n                        />\r\n                      </>\r\n                    ) : (\r\n                      <>\r\n                        <IconButton\r\n                          onClick={() => this.openSignupModal()}\r\n                          label=\"Rekisteröidy\"\r\n                          icon=\"mail\"\r\n                        />\r\n                        <IconButton\r\n                          onClick={() => this.openLoginModal()}\r\n                          label=\"Kirjaudu\"\r\n                          icon=\"padlock\"\r\n                        />\r\n                      </>\r\n                    )}\r\n                  </div>\r\n                  <IconButton\r\n                    onClick={() => this.setState(({ mobileNavIsOpen }) => ({\r\n                      mobileNavIsOpen: !mobileNavIsOpen\r\n                    }))}\r\n                    label=\"Menu\"\r\n                    icon=\"dial\"\r\n                    className=\"menu-toggler\"\r\n                  />\r\n                </nav>\r\n              </div>\r\n            </header>\r\n          </>\r\n        )}\r\n      </AuthContext.Consumer>\r\n    )\r\n  }\r\n}\r\n","import React, { Component } from 'react'\r\nimport Loader from './Loader'\r\nimport createUrl from '../helpers/createUrl'\r\nimport '../styles/ListingHolder.scss'\r\n\r\nexport default class extends Component {\r\n  constructor (props) {\r\n    super(props)\r\n    this.lastOptions = JSON.stringify(props.options)\r\n    this.state = {\r\n      listingsEndpoint: '',\r\n      listings: []\r\n    }\r\n    // this.setListingEndpoint()\r\n    this.instersectionObserver = new IntersectionObserver(this.intersectionHandler)\r\n  }\r\n\r\n  componentDidMount () {\r\n    this.setListingEndpoint()\r\n  }\r\n\r\n  componentDidUpdate () {\r\n    const currentOptions = JSON.stringify(this.props.options)\r\n\r\n    if (this.lastOptions !== currentOptions) {\r\n      console.log('Options have changed...')\r\n      this.lastOptions = currentOptions\r\n      this.setListingEndpoint()\r\n    } else {\r\n      console.log('Options have not changed.')\r\n    }\r\n  }\r\n\r\n  componentWillUnmount () {\r\n    this.instersectionObserver.disconnect()\r\n  }\r\n\r\n  setListingEndpoint = () => {\r\n    const listingsEndpoint = createUrl('/listings', {\r\n      limit: this.props.limit || 12,\r\n      page: 0,\r\n      ...this.props.options\r\n    })\r\n\r\n    console.log(`Setting initial listingsEndpoint to be ${listingsEndpoint}`)\r\n\r\n    this.setState({\r\n      listingsEndpoint,\r\n      listings: []\r\n    }, () => this.loadListings())\r\n  }\r\n\r\n  loadListings = async () => {\r\n    if (this.state.listingsEndpoint) {\r\n      try {\r\n        const response = await fetch(this.state.listingsEndpoint)\r\n\r\n        if (response.ok) {\r\n          const { data, next } = await response.json()\r\n    \r\n          const uniqueListings = data.filter(({ _id }) => (\r\n            this.state.listings.find(l => l._id === _id) ? false : true\r\n          ))\r\n    \r\n          this.setState(state => ({\r\n              listings: [...state.listings, ...uniqueListings],\r\n              listingsEndpoint: next\r\n          }))\r\n          console.log(`Setting next listingsEndpoint to be ${next}`)\r\n        } else {\r\n          console.error(response)\r\n        }\r\n      } catch (error) {\r\n        console.error(error)\r\n      }\r\n    } else {\r\n      console.log('Load listings triggered but theres no endpoint to load from')\r\n    }\r\n  }\r\n\r\n  intersectionHandler = (entries) => {\r\n    if (entries.some(e => e.isIntersecting)) this.loadListings()\r\n  }\r\n\r\n  setRef = (ref) => {\r\n    this.loaderRef = ref\r\n\r\n    if (this.loaderRef) {\r\n      this.instersectionObserver.observe(this.loaderRef)\r\n    }\r\n  }\r\n\r\n  render () {\r\n    return (\r\n      <>\r\n        <section className=\"ListingHolder\">\r\n\r\n          {this.state.listings.map(this.props.children)}\r\n\r\n        </section>\r\n\r\n        {this.state.listingsEndpoint ? <Loader setRef={this.setRef} /> : ''}\r\n      </>\r\n    )\r\n  }\r\n}\r\n","import React, { useState } from 'react'\r\nimport Placeholder from '../assets/placeholder.png'\r\n\r\nexport default ({ src, alt, ...props }) => {\r\n  const [source, setSource] = useState(src)\r\n  const [errored, setErrored] = useState(false)\r\n\r\n  const onError = () => {\r\n    if (!errored) {\r\n      setSource(Placeholder)\r\n      setErrored(true)\r\n    }\r\n  }\r\n\r\n  return (\r\n    <img\r\n      src={source}\r\n      alt={alt || ''}\r\n      onError={onError}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n","import React from 'react'\r\nimport { Link } from 'react-router-dom'\r\nimport Image from './Image'\r\nimport Placeholder from '../assets/placeholder.png'\r\n\r\nconst maxDescLen = 72\r\n\r\nexport default ({ title, description, id, images }) => (\r\n  <article className=\"listingPreview\">\r\n    {images.length ? <Image src={images[0]} alt={title} /> : <Image src={Placeholder} alt={title} />}\r\n\r\n    <h1>{title}</h1>\r\n    <p>{description.length > maxDescLen ?\r\n      description.substring(0, maxDescLen) + '...'\r\n      : description}\r\n    </p>\r\n    <Link to={`/listings/${id}`} className=\"btn-primary\">\r\n      Lue lisää\r\n    </Link>\r\n  </article>\r\n)\r\n","import React, { useState } from 'react'\r\nimport { Helmet } from 'react-helmet'\r\n\r\nimport TextInput from '../components/TextInput'\r\nimport ListingHolder from '../components/ListingHolder'\r\nimport ListingPreview from '../components/ListingPreview'\r\nimport '../styles/LandingPage.scss'\r\nimport ShoppingImage from '../assets/shopping.svg'\r\n\r\nexport default () => {\r\n  const [searchOptions, setSearchOptions] = useState({})\r\n\r\n  const updateSearchOptions = event => {\r\n    const searchString = event.target.value\r\n    setSearchOptions({ searchString })\r\n  }\r\n\r\n  return (\r\n    <>\r\n      <Helmet>\r\n        <title>Swapza</title>\r\n        <meta name=\"description\" content={\r\n          'Vaihdantataloudella toimiva verkkokauppa.'\r\n        } />\r\n      </Helmet>\r\n\r\n      <main className=\"landing d12 m6\">\r\n        <h1>Raha on niin viime vuosituhatta</h1>\r\n        <p>Vaihda hetki aikaasi tavaraksi, tai vaikka vanhoja vaatteitasi nurmikonleikkuusta.</p>\r\n        <div>\r\n          <TextInput label=\"Hae tuotteita tai palveluita\" onChange={updateSearchOptions} />\r\n        </div>\r\n      </main>\r\n      <div className=\"landing-image m6\">\r\n        <img src={ShoppingImage} alt=\"Illustraatio verkkokaupasta\" />\r\n      </div>\r\n      <div className=\"d12\">\r\n        <h2>Selaa ja hae listauksia</h2>\r\n        <ListingHolder options={searchOptions}>\r\n          {({ _id, ...rest }) => (\r\n            <ListingPreview key={_id} id={_id} {...rest} />\r\n          )}\r\n        </ListingHolder>\r\n      </div>\r\n    </>\r\n  )\r\n}\r\n","import React, { Component } from 'react'\r\nimport { Link, withRouter } from 'react-router-dom'\r\n\r\nimport { AuthContext } from '../components/AuthContext'\r\nimport createUrl from '../helpers/createUrl'\r\nimport '../styles/Offers.scss'\r\nimport getUser from '../helpers/getUser'\r\nimport fetchWithAuth from '../helpers/fetchWithAuth'\r\n\r\nclass RealOffer extends Component {\r\n  constructor (props) {\r\n    super(props)\r\n    this.state = {\r\n      username: '',\r\n      listingName: ''\r\n    }\r\n  }\r\n\r\n  async componentDidMount () {\r\n    const { creatorId, creatorListingId } = this.props\r\n    const userUrl = createUrl(`/users/${creatorId}`)\r\n    const listingUrl = createUrl(`/listings/${creatorListingId}`)\r\n\r\n    try {\r\n      const [user, listing] = await Promise.all([\r\n        fetch(userUrl), fetch(listingUrl)\r\n      ])\r\n      const jsonCalls = []\r\n      if (user.ok) jsonCalls.push(user.json())\r\n      if (listing.ok) jsonCalls.push(listing.json())\r\n      const [{ username }, { title }] = await Promise.all(jsonCalls)\r\n      this.setState({ username, listingName: title })\r\n    } catch (error) {\r\n      console.error(error)\r\n    }\r\n  }\r\n\r\n  setAccept = async (accepted) => {\r\n    const url = createUrl(`/listings/${\r\n      this.props.location.pathname.split('/')[2]\r\n    }/offers/${this.props._id}`)\r\n\r\n    try {\r\n      const res = await fetchWithAuth(url, {\r\n        method: 'PUT',\r\n        headers: {\r\n          'Content-Type': 'application/json'\r\n        },\r\n        body: JSON.stringify({ accepted })\r\n      })\r\n\r\n      if (res.ok) {\r\n        console.log(`Offer ${accepted ? 'accepted' : 'rejected'}`)\r\n      } else {\r\n        console.error(res)\r\n      }\r\n    } catch (error) {\r\n      console.error(error)\r\n    }\r\n  }\r\n\r\n  render () {\r\n    const { creatorId, creatorListingId, listingCreator } = this.props\r\n    const { username, listingName } = this.state\r\n\r\n    return (\r\n      <li className=\"offer\">\r\n        <span>\r\n          <Link to={`/users/${creatorId}`}>\r\n            {username || 'Loading'}\r\n          </Link> tarjosi <Link to={`/listings/${creatorListingId}`}>\r\n            {listingName || 'loadingin...'}\r\n          </Link>\r\n        </span>\r\n\r\n        <AuthContext.Consumer>\r\n          {context => {\r\n            if (!context.isAuthenticated) return null\r\n            if (getUser().id !== listingCreator) return null\r\n\r\n            return (\r\n              <div>\r\n                <button\r\n                  onClick={() => this.setAccept(true)}\r\n                  className=\"btn-primary\"\r\n                >Hyväksy</button>\r\n                <button\r\n                  onClick={() => this.setAccept(false)}\r\n                  className=\"btn\"\r\n                >Hylkää</button>\r\n              </div>\r\n            )\r\n          }}\r\n        </AuthContext.Consumer>\r\n      </li>\r\n    )\r\n  }\r\n}\r\n\r\nconst Offer = withRouter(props => <RealOffer {...props} />)\r\n\r\nexport default (props) => (\r\n  <ul>\r\n    {props.offers.map((offer) => (\r\n      <Offer key={offer._id} listingCreator={props.listingCreator} {...offer} />\r\n    ))}\r\n  </ul>\r\n)\r\n","import React, { Component } from 'react'\r\n\r\nexport default class extends Component {\r\n  render () {\r\n    return (\r\n        <section onClick={this.props.onClick}>\r\n          <p>{this.props.title}</p>\r\n        </section>\r\n    )\r\n  }\r\n}\r\n","import React, { Component } from 'react'\r\n\r\nimport Form from './Form'\r\nimport ListingHolder from '../components/ListingHolder'\r\n\r\nimport ListingData from './ListingData'\r\nimport fetchWithAuth from '../helpers/fetchWithAuth'\r\nimport createUrl from '../helpers/createUrl'\r\nimport getUser from '../helpers/getUser'\r\n\r\nexport default class extends Component {\r\n  constructor (props) {\r\n    super(props)\r\n    this.state = {\r\n      offer: '',\r\n      creatorId: ''\r\n    }\r\n  }\r\n\r\n  submit = async (event) => {\r\n    event.preventDefault()\r\n    const url = createUrl(`/listings/${this.props.listingId}/offer`)\r\n    const settings = {\r\n      method: 'POST',\r\n      headers: {\r\n          'Content-Type': 'application/json'\r\n      },\r\n      body: JSON.stringify({\r\n        creatorId: this.state.creatorId,\r\n        creatorListingId: this.state.offer\r\n      })\r\n    }\r\n\r\n    try {\r\n      const response = await fetchWithAuth(url, settings)\r\n\r\n      if (response.ok) {\r\n        console.log('Tarjous tehty onnistuneesti')\r\n        window.location.reload()\r\n      } else {\r\n        console.error(response)\r\n      }\r\n    } catch (error) {\r\n      console.error(error)\r\n    }\r\n  }\r\n\r\n  render () {\r\n    return (\r\n      <Form onSubmit={this.submit}>\r\n          <ListingHolder options={{ creatorId: getUser().id }}>\r\n            {({ _id, ...rest }) => (\r\n              <ListingData key={_id}\r\n                id={_id} {...rest}\r\n                onClick={() => this.setState({\r\n                  offer: _id,\r\n                  creatorId: rest.creatorId\r\n                })}\r\n              />\r\n            )}\r\n          </ListingHolder>\r\n          <p>Valinta: {this.state.offer}</p>\r\n          <button type=\"submit\" className=\"btn-primary\">\r\n            Lähetä tarjous\r\n          </button>\r\n      </Form>\r\n    )\r\n  }\r\n}\r\n","import React, { Component } from 'react'\r\n\r\nimport createUrl from '../helpers/createUrl'\r\nimport {Link} from 'react-router-dom'\r\n\r\nexport default class extends Component {\r\n  constructor (props) {\r\n    super(props)\r\n      this.state = {\r\n          userName: '',\r\n          location: ''\r\n      }\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.getUser()\r\n  }\r\n\r\n  getUser = async () => {\r\n    const url = createUrl(`/users/${this.props.userID}`)\r\n    \r\n    try {\r\n      const response = await fetch(url)\r\n\r\n      if (response.ok) {\r\n          const user = await response.json()\r\n          this.setState({\r\n              userName: user.username,\r\n              location: user.location\r\n          })\r\n      } else {\r\n        console.error(response)\r\n      }\r\n    } catch (error) {\r\n      console.error(error)\r\n    }\r\n  }\r\n\r\n  render () {\r\n    return (\r\n      <div className=\"row\">\r\n        <section className=\"d12 m8\">\r\n          <h3>\r\n          <Link to={`/users/${this.props.userID}`}>\r\n            {this.state.userName}\r\n          </Link>\r\n          </h3> <br/>\r\n          <p>Sijainti: {this.state.location}</p>\r\n        </section>\r\n      </div>\r\n    )\r\n  }\r\n}\r\n","import React, { Component } from 'react'\r\nimport { Helmet } from 'react-helmet'\r\n\r\nimport Offers from '../components/Offers'\r\nimport Loader from '../components/Loader'\r\nimport OfferForm from '../components/OfferForm'\r\nimport IconButton from '../components/IconButton'\r\nimport Modal from '../components/Modal'\r\nimport Image from '../components/Image'\r\nimport { AuthContext } from '../components/AuthContext'\r\nimport createUrl from '../helpers/createUrl'\r\nimport ProfilePreview from '../components/ProfilePreview'\r\n\r\nimport '../styles/ListingPage.scss'\r\nimport ROLES from '../helpers/roles'\r\nimport getUser from '../helpers/getUser'\r\nimport fetchWithAuth from '../helpers/fetchWithAuth'\r\n\r\nexport default class extends Component {\r\n  constructor (props) {\r\n    super(props)\r\n    this.state = {\r\n      listing: {}\r\n    }\r\n  }\r\n\r\n  componentDidMount () {\r\n    this.loadListing(this.props.match.params.id)\r\n  }\r\n\r\n  componentWillReceiveProps (nextProps) {\r\n    if(this.props.match.params.id !== nextProps.match.params.id) {\r\n      this.loadListing(nextProps.match.params.id)\r\n    }\r\n  }\r\n\r\n  loadListing = async (id) => {\r\n    const url = createUrl(`/listings/${id}`)\r\n\r\n    try {\r\n      const response = await fetch(url)\r\n\r\n      if (response.ok) {\r\n        const listing = await response.json()\r\n        this.setState({ listing })\r\n      } else {\r\n        this.setState({ listing: {\r\n          title: 'Not found',\r\n          description: 'Wrong ID in the URL...',\r\n          images: [],\r\n          offers: [],\r\n          notFound: true\r\n        }})\r\n      }\r\n    } catch (error) {\r\n      console.error('[ListingPage:loadListing]', error)\r\n    }\r\n  }\r\n\r\n  removeListing = async () => {\r\n    const url = createUrl(`/listings/${this.props.match.params.id}`)\r\n\r\n    try {\r\n      const response = await fetchWithAuth(url, { method: 'DELETE' })\r\n\r\n      if (response.ok) {\r\n        this.props.history.push('/')\r\n      } else {\r\n        alert('Jotain meni pieleen...')\r\n      }\r\n    } catch (error) {\r\n      alert('Jotain meni pieleen...')\r\n      console.error('[ListingPage:loadListing]', error)\r\n    }\r\n  }\r\n\r\n  render () {\r\n    const { title, description, images, offers, creatorId } = this.state.listing\r\n\r\n    return (\r\n      <main>\r\n        {title && description ? (\r\n          <>\r\n            <Helmet>\r\n              <title>{title}</title>\r\n              <meta name=\"description\" content={description} />\r\n            </Helmet>\r\n\r\n            <div className=\"row\">\r\n              <section className=\"d12 m8\">\r\n                {images.length ? <Image src={images[0]} alt={title} /> : null}\r\n\r\n                <h1>{title}</h1>\r\n                <p>{description}</p>\r\n\r\n                <AuthContext.Consumer>\r\n                  {context => {\r\n                    if (!context.isAuthenticated) return null\r\n                    const { role, id } = getUser()\r\n\r\n                    if (id === creatorId || role === ROLES.ADMIN) {\r\n                      return <button className=\"btn\" onClick={this.removeListing}>Poista listaus</button>\r\n                    }\r\n                  }}\r\n                </AuthContext.Consumer>\r\n                \r\n              </section>\r\n              <section className=\"d12 m4\">\r\n                <h2>Myyjän tiedot</h2>\r\n                <ProfilePreview userID={this.state.listing.creatorId}/>\r\n              </section>\r\n            </div>\r\n\r\n            <div className=\"row\">\r\n              {!this.state.listing.notFound && (\r\n                <section className=\"d12 m8\">\r\n                  <header className=\"offer-container-header\">\r\n                    <h2>Tarjoukset</h2>\r\n                    <AuthContext.Consumer>\r\n                      {context => {\r\n                        return context.isAuthenticated ? (\r\n                          <>\r\n                            <Modal setOpener={open => this.openOfferForm = open}>\r\n                              <OfferForm listingId={this.props.match.params.id}/>\r\n                            </Modal>\r\n                            <IconButton\r\n                              onClick={() => this.openOfferForm()}\r\n                              label=\"Tee tarjous\"\r\n                              icon=\"paper-plane-1\"\r\n                            />\r\n                          </>\r\n                        ) : null\r\n                      }}\r\n                    </AuthContext.Consumer>\r\n                  </header>\r\n                  {offers.length ?\r\n                    <Offers offers={offers} listingCreator={creatorId} />\r\n                    : 'Ei tarjouksia'}\r\n                </section>\r\n              )}\r\n            </div>\r\n          </>\r\n        ) : <Loader />}\r\n      </main>\r\n    )\r\n  }\r\n}\r\n","import React from 'react'\r\n\r\nexport default ({ id, label, type, name, ...rest }) => (\r\n  <div className=\"textarea-float-label\">\r\n    <textarea id={id}\r\n      name={name || id}\r\n      placeholder={label}\r\n      type={type || \"text\"}\r\n      maxLength=\"600\"\r\n      {...rest}\r\n    ></textarea>\r\n    <label htmlFor={id}>{label}</label>\r\n  </div>\r\n)\r\n","import React, { Component } from 'react'\r\n\r\nimport Form from './Form'\r\n\r\nimport fetchWithAuth from '../helpers/fetchWithAuth'\r\nimport createUrl from '../helpers/createUrl'\r\nimport TextInput from '../components/TextInput'\r\nimport TextArea from '../components/TextArea'\r\n\r\n\r\nexport default class extends Component {\r\n  constructor (props) {\r\n    super(props)\r\n      this.state = {\r\n        location: '',\r\n        description: ''\r\n      }\r\n  }\r\n\r\n  submit = async (event) => {\r\n    event.preventDefault()\r\n    const url = createUrl(`/users/${this.props.id}`)\r\n    console.log(url)\r\n\r\n    const settings = {\r\n      method: 'PUT',\r\n      headers: {\r\n          'Content-Type': 'application/json'\r\n      },\r\n      body: JSON.stringify({\r\n        location: this.state.location,\r\n        description: this.state.description\r\n      })\r\n    }\r\n\r\n    try {\r\n      const response = await fetchWithAuth(url, settings)\r\n\r\n      if (response.ok) {\r\n        console.log('tiedot vaihdettu')\r\n        window.location.reload()\r\n      } else {\r\n        console.error(response)\r\n      }\r\n    } catch (error) {\r\n      console.error(error)\r\n    }\r\n  }\r\n\r\n  changeDescription = (event) => this.setState({description: event.target.value})\r\n\r\n  changeLocation = (event) => this.setState({location: event.target.value})\r\n\r\n  render () {\r\n    return (\r\n      <Form onSubmit={this.submit}>\r\n        <TextInput\r\n            label=\"Sijainti\" id=\"location_id\" name=\"location\" type=\"text\" onChange={this.changeLocation} required\r\n        />\r\n        <TextArea\r\n            label=\"Kuvaus\" id=\"description_id\" name=\"description\" onChange={this.changeDescription} required\r\n        />\r\n        <button type=\"submit\" className=\"btn-primary\">\r\n          Muuta tietoja\r\n        </button>\r\n      </Form>\r\n    )\r\n  }\r\n}\r\n","import React, { Component } from 'react'\r\n\r\nimport Form from './Form'\r\n\r\nimport fetchWithAuth from '../helpers/fetchWithAuth'\r\nimport createUrl from '../helpers/createUrl'\r\nimport TextArea from '../components/TextArea'\r\nimport getUser from '../helpers/getUser'\r\n\r\n\r\nexport default class extends Component {\r\n  constructor (props) {\r\n    super(props)\r\n      this.state = {\r\n        comment: '',\r\n        isPositive: null\r\n      }\r\n  }\r\n\r\n  submit = async (event) => {\r\n    event.preventDefault()\r\n    const url = createUrl(`/users/${this.props.id}/rating`)\r\n    console.log(url)\r\n    const settings = {\r\n      method: 'POST',\r\n      headers: {\r\n          'Content-Type': 'application/json'\r\n      },\r\n      body: JSON.stringify({\r\n        creatorId: getUser().id,\r\n        comment: this.state.comment,\r\n        isPositive: this.state.isPositive\r\n      })\r\n    }\r\n\r\n    try {\r\n      const response = await fetchWithAuth(url, settings)\r\n\r\n      if (response.ok) {\r\n        console.log('palaute annettu')\r\n        window.location.reload()\r\n      } else {\r\n        console.error(response)\r\n      }\r\n    } catch (error) {\r\n      console.error(error)\r\n    }\r\n  }\r\n\r\n  changeComment = (event) => this.setState({comment: event.target.value})\r\n\r\n  changeRating = (event) => {\r\n      if (event.target.value === 'positive') {\r\n          this.setState({isPositive: true})\r\n      } else {\r\n          this.setState({isPositive: false})\r\n      }\r\n  }\r\n\r\n  render () {\r\n    return (\r\n      <Form onSubmit={this.submit}>\r\n        <TextArea\r\n            label=\"Kommentoi\" id=\"description_id\" name=\"description\" onChange={this.changeComment} required\r\n        />\r\n        <div onChange={this.changeRating}>\r\n        <p>Suosittelisitko myyjää?</p>\r\n        <input type=\"radio\" id =\"positive\" value=\"positive\" name=\"rating\" /> <label htmlFor=\"positive\">Kyllä</label><br/>\r\n        <input type=\"radio\" id =\"negative\" value=\"negative\" name=\"rating\" /> <label htmlFor=\"negative\">En</label>\r\n        </div>\r\n        <button type=\"submit\" className=\"btn-primary\">\r\n          Anna palaute\r\n        </button>\r\n      </Form>\r\n    )\r\n  }\r\n}\r\n","import React, { Component } from 'react'\r\n\r\nexport default class extends Component {\r\n  constructor (props) {\r\n    super(props)\r\n    this.state = {\r\n      ratingArray: []\r\n    }\r\n  }\r\n\r\n  componentDidMount () {\r\n    this.getRatings()\r\n  }\r\n\r\n\r\n  getRatings = () => {\r\n    for (let i = 0; i < this.props.ratings.length; i++) {\r\n      let item = <p>{this.props.ratings[i].comment}</p>\r\n      this.setState(state => ({\r\n        ratingArray: [...state.ratingArray, item]\r\n      }))\r\n    }\r\n  }\r\n\r\n  render () {\r\n    return (\r\n      <>\r\n        {this.state.ratingArray}\r\n      </>\r\n    )\r\n  }\r\n}\r\n","import React, { Component } from 'react'\r\n\r\nexport default class extends Component {\r\n  constructor (props) {\r\n    super(props)\r\n    this.state = {\r\n      votes: 0,\r\n      totalPositive: 0,\r\n      totalNegative: 0\r\n    }\r\n  }\r\n\r\n  componentDidMount () {\r\n    this.getVotes()\r\n  }\r\n\r\n\r\n  getVotes = () => {\r\n      let votes = 0\r\n      let totalPositive = 0\r\n      let totalNegative = 0\r\n    for (let i = 0; i < this.props.ratings.length; i++) {\r\n      if (this.props.ratings[i].isPositive) {\r\n          votes++\r\n          totalPositive++\r\n      } else {\r\n          votes--\r\n          totalNegative++\r\n      }\r\n    }\r\n    this.setState({votes: votes})\r\n    this.setState({totalPositive: totalPositive})\r\n    this.setState({totalNegative: totalNegative})\r\n  }\r\n\r\n  render () {\r\n    return (\r\n      <>\r\n        <p>{this.state.votes} Pistettä {this.state.totalPositive} Positiivista {this.state.totalNegative} Negatiivista</p>\r\n      </>\r\n    )\r\n  }\r\n}\r\n","import React, { Component } from 'react'\r\nimport { Helmet } from 'react-helmet'\r\n\r\nimport Loader from '../components/Loader'\r\nimport ListingHolder from '../components/ListingHolder'\r\nimport ListingPreview from '../components/ListingPreview'\r\nimport EditForm from '../components/EditForm'\r\nimport Modal from '../components/Modal'\r\nimport createUrl from '../helpers/createUrl'\r\nimport RatingForm from '../components/RatingForm'\r\nimport RatingsHolder from '../components/RatingsHolder'\r\nimport RatingsAverage from '../components/RatingsAverage'\r\nimport getUser from '../helpers/getUser'\r\nimport { AuthContext } from '../components/AuthContext'\r\n\r\nexport default class extends Component {\r\n  constructor (props) {\r\n    super(props)\r\n    this.state = {\r\n      user: {}\r\n    }\r\n  }\r\n\r\n  componentDidMount () {\r\n    this.loadUser()\r\n  }\r\n\r\n  loadUser = async () => {\r\n    const url = createUrl(`/users/${this.props.match.params.id}`)\r\n\r\n    try {\r\n      const response = await fetch(url)\r\n      const user = await response.json()\r\n      this.setState({ user })\r\n    } catch (error) {\r\n      console.error('[userPage:loaduser]', error)\r\n    }\r\n  }\r\n\r\n  render () {\r\n    const { username, ratings, location, description } = this.state.user\r\n\r\n    return (\r\n      <main>\r\n        {username ? (\r\n          <>\r\n            <Helmet>\r\n              <title>{username}</title>\r\n            </Helmet>\r\n\r\n            <div className=\"row\">\r\n              <section className=\"d12 m8\">\r\n                <h1>{username}</h1>\r\n                {location ? <p>Sijainti: {location}</p> : null}\r\n                {description ? <p>{description}</p> : null}\r\n                {ratings ? <p>Palaute: <RatingsAverage ratings={ratings} /> </p> : null}\r\n\r\n                {getUser() && this.props.match.params.id === getUser().id ? <div><button className=\"btn-primary\" onClick={() => this.openEditModal()}>Muokkaa tietoja</button></div> : null}\r\n              </section>\r\n              <section className=\"d12 m4\">\r\n                <AuthContext.Consumer>\r\n                  {context => (\r\n                    context.isAuthenticated ? (\r\n                      <>\r\n                        <h2>Kirjoita kommentti</h2>\r\n                        <RatingForm id={this.props.match.params.id}/>\r\n                        <Modal setOpener={open => this.openEditModal = open}>\r\n                          <EditForm id={this.props.match.params.id} />\r\n                        </Modal>\r\n                      </>\r\n                    ) : null\r\n                  )}\r\n                </AuthContext.Consumer>\r\n\r\n                <h2>Kommentit</h2>\r\n                <RatingsHolder ratings={ratings} />\r\n              </section>\r\n            </div>\r\n            \r\n            <div className=\"row\">\r\n              <section className=\"d12 m8\">\r\n                <h2>Listaukset</h2>\r\n                <ListingHolder options={{creatorId: this.props.match.params.id}}>\r\n                  {({ _id, ...rest }) => (\r\n                    <ListingPreview key={_id} id={_id} {...rest} />\r\n                  )}\r\n                </ListingHolder>\r\n              </section>\r\n            </div>\r\n            \r\n          </>\r\n        ) : <Loader />}\r\n      </main>\r\n    )\r\n  }\r\n}\r\n","import React, { Component } from 'react'\r\nimport { Helmet } from 'react-helmet'\r\nimport createUrl from '../helpers/createUrl'\r\n\r\nexport default class extends Component {\r\n  constructor (props) {\r\n    super(props)\r\n    this.state = {\r\n      verifying: 'Vahvistetaan sähköpostia...'\r\n    }\r\n  }\r\n\r\n  async componentDidMount () {\r\n    const url = createUrl('/users/verify')\r\n\r\n    try {\r\n      const response = await fetch(url, {\r\n        method: 'PUT',\r\n        headers: {\r\n          'Content-Type': 'application/json'\r\n        },\r\n        body: JSON.stringify({\r\n          key: new URLSearchParams(this.props.location.search).get('key')\r\n        })\r\n      })\r\n\r\n      if (response.ok) {\r\n        this.setState({ verifying: 'Verified! You can now log in!' })\r\n      } else {\r\n        this.setState({ verifying: 'Could not verify...' })\r\n        console.log(response)\r\n      }\r\n    } catch (error) {\r\n      this.setState({ verifying: 'Could not verify...' })\r\n      console.log(error)\r\n    }\r\n  }\r\n\r\n  render () {\r\n    return (\r\n      <main>\r\n        <Helmet>\r\n          <title>Sähköpostin vahvistus</title>\r\n        </Helmet>\r\n\r\n        <div className=\"row\">\r\n          <h1>{this.state.verifying}</h1>\r\n        </div>\r\n      </main>\r\n    )\r\n  }\r\n}\r\n","import React, { useState, useRef } from 'react'\r\n\r\nexport default ({ id, label, type, name, ...rest }) => {\r\n  const [filenames, setFilenames] = useState([])\r\n  const input = useRef(null)\r\n\r\n  const onChange = event => {\r\n    const files = event.target.files\r\n    setFilenames(Array.prototype.map.call(files, f => f.name))\r\n  }\r\n\r\n  return (\r\n    <div className=\"file-input\" onClick={() => input.current.click()}>\r\n      <input\r\n        ref={input}\r\n        id={id}\r\n        name={name || id}\r\n        type=\"file\"\r\n        onChange={onChange}\r\n        className={filenames.length ? 'hasFiles' : ''}\r\n        {...rest}\r\n      />\r\n      <label htmlFor={id}>{label}</label>\r\n\r\n      {filenames.length ? <span>{filenames.join(', ')}</span> : '' }\r\n    </div>\r\n  )\r\n}\r\n","import React, { Component } from 'react'\r\n\r\nimport Form from '../components/Form'\r\nimport TextInput from '../components/TextInput'\r\nimport TextArea from '../components/TextArea'\r\nimport FileInput from '../components/FileInput'\r\nimport Loader from '../components/Loader'\r\nimport createUrl from '../helpers/createUrl'\r\nexport default class extends Component {\r\n  constructor (props) {\r\n    super(props)\r\n    this.state = {\r\n      responseMsg: '',\r\n      submitting: false\r\n    }\r\n  }\r\n\r\n  render () { \r\n    return (\r\n      <>\r\n        <Form\r\n          auth\r\n          url={createUrl('/listings')}\r\n          method=\"POST\"\r\n          multipart\r\n          setLoader={() => this.setState({ submitting: true })}\r\n          onSuccess={() => this.setState({ submitting: false, responseMsg: 'Listaus luotu onnistuneesti!' })}\r\n          onError={() => this.setState({ submitting: false, responseMsg: 'Jotain meni pieleen...' })}\r\n          >\r\n          <TextInput\r\n            label=\"Listauksen nimi\" id=\"create_title\" name=\"title\"\r\n            required\r\n          />\r\n          <TextArea\r\n            label=\"Tuotteen tai palvelun kuvaus\" id=\"create_description\" name=\"description\"\r\n            required\r\n          />\r\n          <TextInput\r\n            label=\"Avainsanoja tuotteelle (erottele pilkulla)\" id=\"create_keywords\" name=\"keywords\"\r\n            required\r\n          />\r\n          <FileInput\r\n            label=\"Kuva(t)\"\r\n            id=\"create_picture\"\r\n            name=\"pics\"\r\n            multiple\r\n          />\r\n  \r\n          {this.state.submitting\r\n            ? <Loader />\r\n            : <button type=\"submit\" className=\"btn-primary\">\r\n                Submit\r\n              </button>\r\n          }\r\n        </Form>\r\n        {this.state.responseMsg && <p>{this.state.responseMsg}</p>}\r\n      </>\r\n    )\r\n  }\r\n}","import React, { Component } from 'react'\r\nimport { Helmet } from 'react-helmet'\r\n\r\n\r\nimport CreateListingForm from '../components/CreateListingForm'\r\n\r\nexport default class extends Component {\r\n  render () { \r\n    return (\r\n      <main className=\"row\">\r\n        <Helmet>\r\n          <title>Luo listaus</title>\r\n        </Helmet>\r\n\r\n        <div className=\"d12\">\r\n          <h1>Luo listaus</h1>\r\n          <CreateListingForm />\r\n        </div>\r\n      </main>\r\n    )\r\n  }\r\n}\r\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' }\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from 'react'\nimport ReactDOM from 'react-dom'\nimport './styles/index.scss'\nimport App from './App'\nimport * as serviceWorker from './serviceWorker'\n\nReactDOM.render(<App />, document.getElementById('root'))\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister()\n","import React from 'react'\nimport {\n  BrowserRouter as Router,\n  Route,\n  Switch,\n  withRouter\n} from 'react-router-dom'\nimport { Helmet } from 'react-helmet'\n\nimport ROLES from './helpers/roles'\nimport { AuthProvider } from './components/AuthContext'\nimport ProtectedRoute from './components/ProtectedRoute'\n\nimport Navbar from './components/Navbar'\nimport LandingPage from './pages/LandingPage'\nimport ListingPage from './pages/ListingPage'\nimport ProfilePage from './pages/ProfilePage'\nimport VerificationPage from './pages/VerificationPage'\nimport CreateListingPage from './pages/CreateListingPage'\n\nexport default () => (\n  <Router>\n    <AuthProvider>\n      <Helmet titleTemplate=\"%s - Swapza\" />\n\n      <Navbar />\n\n      <div className=\"wrap\">\n        <Switch>\n          <Route path=\"/\" exact component={LandingPage} />\n          <Route path=\"/listings/:id\" component={withRouter(ListingPage)} />\n          <Route path=\"/users/:id\" component={withRouter(ProfilePage)} />\n          <Route path=\"/verify\" component={VerificationPage} />\n\n          <ProtectedRoute level={ROLES.BASIC} path=\"/create\" component={CreateListingPage} />\n          <ProtectedRoute level={ROLES.ADMIN} path=\"/admin\" render={() => 'Vain adminit voivat nähdä tämän tekstin'} />\n\n          <Route render={() => '404 Not found'}/>\n        </Switch>\n      </div>\n    </AuthProvider>\n  </Router>\n)\n"],"sourceRoot":""}